<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imprint</title>
    <style>
        :root {
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #0f172a;
            --muted: #475569;
            --accent: #2563eb;
            --radius: 10px;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 2rem;
            transition: background 0.3s, color 0.3s;
        }

        header {
            display: flex;
            align-items: center;
            flex-direction: row;
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        p {
            color: var(--muted);
        }

        button {
            background: var(--accent);
            border: none;
            padding: 0.8rem 2rem;
            color: white;
            border-radius: var(--radius);
            cursor: pointer;
            font-size: 1rem;
            margin-top: 1rem;
            display: grid;
            width: 100%;
            gap: 1rem;
        }

        .results {
            margin-top: 2rem;
            display: none;
        }

        .summary, .card {
            background: var(--card);
            padding: 1rem;
            border-radius: var(--radius);
        }

        .summary {
            margin-bottom: 1rem;
        }

        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .badge {
            padding: 0.2rem 0.5rem;
            border-radius: var(--radius);
            font-size: 0.8rem;
            margin-left: 0.5rem;
            color: white;
        }

        .low {
            background: #16a34a
        }

        .medium {
            background: #d97706;
        }

        .high {
            background: #dc2626;
        }

        code {
            background: rgba(0, 0, 0, 0.05);
            color: var(--text);
            padding: 0.2rem 0.4rem;
            border-radius: var(--radius);
            font-size: 0.9rem;
        }

        .icon {
            width: 8rem;
            height: 8rem;
            overflow: visible;
            margin-left: auto;
        }
    </style>
</head>
<body>
    <header>
        <h1>What Does Your Browser Reveal About You?</h1>
        <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M112 320C112 205.1 205.1 112 320 112C383.1 112 439.6 140.1 477.8 184.5C486.4 194.6 501.6 195.7 511.6 187.1C521.6 178.5 522.8 163.3 514.2 153.3C467.3 98.6 397.7 64 320 64C178.6 64 64 178.6 64 320L64 360C64 373.3 74.7 384 88 384C101.3 384 112 373.3 112 360L112 320zM570.5 267.1C567.8 254.1 555 245.8 542.1 248.6C529.2 251.4 520.8 264.1 523.6 277C526.5 290.9 528.1 305.3 528.1 320.1L528.1 360.1C528.1 373.4 538.8 384.1 552.1 384.1C565.4 384.1 576.1 373.4 576.1 360.1L576.1 320.1C576.1 302 574.2 284.3 570.6 267.2zM320 144C301 144 282.6 147 265.5 152.6C250.3 157.6 246.8 176.3 257.2 188.5C264.3 196.8 276 199.3 286.6 196.4C297.2 193.5 308.4 192 320 192C390.7 192 448 249.3 448 320L448 344.9C448 370.1 446.5 395.2 443.6 420.2C441.9 434.8 453 448 467.8 448C479.6 448 489.7 439.4 491.1 427.7C494.4 400.3 496.1 372.7 496.1 345L496.1 320.1C496.1 222.9 417.3 144.1 320.1 144.1zM214.7 212.7C205.6 202.1 189.4 201.3 180.8 212.3C157.7 242.1 144 279.4 144 320L144 344.9C144 369.1 141.4 393.3 136.2 416.8C132.8 432.4 144.1 447.9 160.1 447.9C170.6 447.9 180 440.9 182.3 430.6C188.7 402.5 192 373.8 192 344.8L192 319.9C192 292.7 200.5 267.5 214.9 246.8C222.1 236.4 222.9 222.2 214.7 212.6zM320 224C267 224 224 267 224 320L224 344.9C224 380.8 219.4 416.4 210.2 451C206.4 465.3 216.9 480 231.7 480C241.2 480 249.6 473.8 252.1 464.6C262.6 425.6 268 385.4 268 344.9L268 320C268 291.3 291.3 268 320 268C348.7 268 372 291.3 372 320L372 344.9C372 381.2 368.5 417.3 361.6 452.8C358.9 466.7 369.3 480 383.4 480C393.6 480 402.4 473 404.4 463C412.1 424.2 416 384.7 416 344.9L416 320C416 267 373 224 320 224zM344 320C344 306.7 333.3 296 320 296C306.7 296 296 306.7 296 320L296 344.9C296 404.8 285 464.2 263.5 520.1L257.6 535.4C252.8 547.8 259 561.7 271.4 566.4C283.8 571.1 297.7 565 302.4 552.6L308.3 537.3C331.9 475.9 344 410.7 344 344.9L344 320z"/></svg>
    </header>
    <button id="analyseBtn">Analyse My Browser</button>

    <div class="results" id="results">
        <div class="summary">
            <h2>Fingerprint Summary</h2>
            <p><strong>Hash:</strong> <code id="hashDisplay"></code></p>
            <p><strong>Uniqueness Score:</strong> <span id="scoreDisplay"></span></p>
            <p style="font-size: 0.9rem; color: #94a3b8;">
                This is an educational estimate, not a guarantee.
            </p>
        </div>

        <div class="cards" id="cards"></div>
    </div>

    <script>
        const fontsToTest = [
            "Arial", "Times New Roman", "Courier New", "Roboto", "Georgia", "Verdana", "Trebuchet MS", "Fira Code", "JetBrains Mono", "Comic Sans MS"
        ];

        function detectFonts() {
            const baseFonts = ["monospace", "sans-serif", "serif"];
            const testString = "mmmmmmmmmmlli";
            const testSize = "72px";
            const canvas = document.createElement("canvas");
            const context = canvas.getContext("2d");

            const defaultWidths = {};
            baseFonts.forEach(base => {
                context.font = `${testSize} ${base}`;
                defaultWidths[base] = context.measureText(testString).width;
            });

            return fontsToTest.filter(font => {
                return baseFonts.some(base => {
                    context.font = `${testSize} '${font}', ${base}`;
                    return context.measureText(testString).width !== defaultWidths[base];
                });
            });
        }

        function getWebGLInfo() {
            const canvas = document.createElement("canvas");
            const gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
            if (!gl) return {
                vendor: "Unavailable", 
                renderer: "Unavailable"
            };
            const debugInfo = gl.getExtension("WEBGL_debug_renderer_info");
            return debugInfo ? {
                vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),
                renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)
            } : {vendor: "Hidden", renderer: "Hidden"};
        }

        function getMediaDeviceInfo() {
            try {
                const devices = navigator.mediaDevices.enumerateDevices();

                const counts = {
                    audioinput: 0,
                    audiooutput: 0,
                    vidioinput: 0,
                };

                devices.forEach(device => {
                    counts[device.kind]++;
                });

                return counts;
            } catch (err) {
                return { error: "Media device access blocked"};
            }
        }

        //const mediaInfo = JSON.stringify(getMediaDeviceInfo(), null, 2);
        //alert(mediaInfo);

        const featureSupport = {
            usb: "usb" in navigator,
            bluetooth: "bluetooth" in navigator,
            hid: "hid" in navigator,
            serial: "serial" in navigator,
            share: "share" in navigator,
        };

        //alert(featureSupport.usb);

        function calculateScore(data) {
            let score = 0;
            if (data.fonts.length > 6) score += 30;
            if (![1920, 1366, 1536].includes(data.screen.width)) score += 20;
            if (data.webgl.renderer !== "Hidden") score += 20;
            if (data.hardwareConcurrency >= 8) score += 15;
            if (data.languages.length > 1) score += 15;
            return score;
        }

        function riskBadge(level) {
            return `<span class="badge ${level.toLowerCase()}">${level}</span>`;
        }

        function addCard(title, value, risk, explanation) {
            const card = document.createElement("div");
            card.className = "card";
            card.innerHTML = `
                <h3>${title} ${riskBadge(risk)}</h3>
                <p><code>${value}</code></p>
                <p style="font-size: 0.85rem; color: #94a3b8;">${explanation}</p>
            `;
            document.getElementById(cards.appendChild(card));
        }

        async function hashFingerprint(obj) {
            const data = new TextEncoder().encode(JSON.stringify(obj));
            const hashBuffer = await crypto.subtle.digest("SHA-256", data);
            return Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2, "0")).join("");
        }

        document.getElementById("analyseBtn").onclick = async () => {
            const fonts = detectFonts();
            const webgl = getWebGLInfo();

            const fingerprint = {
                screen: {
                    width: screen.width,
                    height: screen.height,
                    colorDepth: screen.colorDepth,
                    dpr: window.devicePixelRatio
                },
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                languages: navigator.languages,
                hardwareConcurrency: navigator.hardwareConcurrency,
                fonts,
                webgl
            };

            const hash = await hashFingerprint(fingerprint);
            const score = calculateScore(fingerprint);

            document.getElementById("hashDisplay").textContent = hash.slice(0, 38) + "...";
            //document.getElementById("hashDisplay").textContent = hash;
            document.getElementById("scoreDisplay").textContent = `${score}/100 (${score>70?"High":score>30?"Moderate":"Low"} uniqueness)`;

            document.getElementById("cards").innerHTML = "";

            addCard("Screen", `${fingerprint.screen.width}x${fingerprint.screen.height}, Colour Depth ${fingerprint.screen.colorDepth}, DPR ${fingerprint.screen.dpr}`, "Medium", "Unusual screen setups can increase fingerprint uniqueness.");

            addCard("Fonts", `${fonts.length} detected`, "High", "Font combinations are often highly unique and stable.");

            addCard("GPU", webgl.renderer, "Medium", "Graphics hardware helps distinguish devices.");

            addCard("Locale", fingerprint.timezone + " / " + fingerprint.languages.join(", "), "Low", "Common locales offer little uniqueness but still contribute.");

            addCard("Hardware Threads", fingerprint.hardwareConcurrency, "Medium", "CPU thread count can narrow device types.");

            //alert(navigator.deviceMemory);
            //alert(navigator.maxTouchPoints);

            document.getElementById("results").style.display = "block";

        };
    </script>
</body>
</html>

