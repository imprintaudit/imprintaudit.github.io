<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <meta name="description" content="Imprint is a browser fingerprinting tool that runs entirely client-side. It demonstrates which browser features can reveal identifying information about a user.">

    <!-- Open Graph for Facebook, Discord, LinkedIn -->
<meta property="og:title" content="Imprint - What Does Your Browser Reveal About You?">
<meta property="og:description" content="Imprint is a browser fingerprinting tool that runs entirely client-side. It demonstrates which browser features can reveal identifying information about a user.">
<meta property="og:image" content="banner.png">
<meta property="og:url" content="https://imprintaudit.github.io">

<!-- Twitter specific -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Imprint - What Does Your Browser Reveal About You?">
<meta name="twitter:description" content="Imprint is a browser fingerprinting tool that runs entirely client-side. It demonstrates which browser features can reveal identifying information about a user.">
<meta name="twitter:image" content="banner.png">

    <title>Imprint</title>
    <link rel="icon" type="image/x-icon" href="favicon.svg">
    <style>
        :root {
            --bg: #fafafa;
            --card: #ffffff;
            --text: #0f172a;
            --muted: #475569;
            --accent: rgb(37, 99, 235);
            --accent-hover: rgb(27, 89, 225);
            --code: rgba(0, 0, 0, 0.05);
            --code-hover: rgba(0, 0, 0, 0.1);
            --radius: 10px;
        }

        :root.dark {
            --bg: #000000;
            --card: #111111;
            --text: #ffffff;
            --muted: #dddddd;
            --accent: rgb(0, 0, 139);
            --accent-hover: rgb(20, 20, 159);
            --code: rgba(255, 255, 255, 0.1);
            --code-hover: rgba(255, 255, 255, 0.15);
            --radius: 10px;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0rem 2rem;
            transition: background 0.3s, color 0.3s;
        }

        header {
            display: flex;
            align-items: center;
            flex-direction: row;
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        p {
            color: var(--muted);
        }

        #analyseBtn {
            background: var(--accent);
            border: none;
            padding: 0.8rem 2rem;
            color: white;
            border-radius: var(--radius);
            cursor: pointer;
            font-size: 1rem;
            margin-top: 1rem;
            width: 100%;
            gap: 1rem;
        }

        #analyseBtn:hover {
            background: var(--accent-hover);
        }

        .results {
            margin-top: 2rem;
            display: none;
        }

        .summary, .card {
            background: var(--card);
            padding: 1rem;
            border-radius: var(--radius);
        }

        .summary {
            margin-bottom: 1rem;
        }

        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .badge {
            padding: 0.2rem 0.5rem;
            border-radius: var(--radius);
            font-size: 0.8rem;
            margin-left: 0.5rem;
            color: white;
        }

        .low {
            background: #16a34a
        }

        .medium {
            background: #d97706;
        }

        .high {
            background: #dc2626;
        }

        strong {
            color: var(--text);
        }

        .explanation {
            font-size: 0.85rem;
            color: var(--muted);
        }

        code {
            display: inline-block;
            background: var(--code);
            color: var(--text);
            padding: 0.2rem 0.4rem;
            border-radius: var(--radius);
            font-size: 0.9rem;
                        
            max-width: 85%;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        code {
            cursor: pointer;
            margin-left: 0;
        }

        p > code {
            margin-left: 5px;
        }
        
        code:hover {
            background: var(--code-hover);
        }

        #main-icon {
            width: 8rem;
            height: 8rem;
            overflow: visible;
            margin-left: auto;
        }

        .icon {
            width: 1rem;
            height: 1rem;
            overflow: visible;
            margin: 0rem 0.25rem 0rem;
            fill: var(--text);
        }

        a {
            color: var(--text);
            text-decoration: underline;
            cursor: pointer;
        }

        a:visited {
            color: var(--text);
        }

        a:hover {
            color: var(--muted);
        }


.summary-p {
  display: flex;
  align-items: center;
}




.modal {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.6);
  z-index: 1000;
  justify-content: center;
  align-items: center;
}

.modal-content {
  background: var(--card);
  color: var(--text);
  padding: 1rem;
  border-radius: var(--radius);
  max-width: 600px;
  width: 90%;
  max-height: 80%;
  overflow-y: auto;
  position: relative;
  box-shadow: 0 0 20px rgba(0,0,0,0.3);
}

.closeModal {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: none;
  border: none;
  font-size: 2rem;
  cursor: pointer;
  color: var(--muted);
}






body {
    display: flex;
    flex-direction: column;
    min-height: 100vh; /* full viewport height */
  }

  /* Main content should expand to fill available space */
  main {
    flex: 1; /* grow to take remaining space */
  }

  /* Footer styling */
  footer {
    text-align: center;
    padding: 0.5rem;
  }






    </style>
</head>
<body>
    <main>

        <header>
            <h1>What Does Your Browser Reveal About You?</h1>
        <svg class="icon" id="main-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M112 320C112 205.1 205.1 112 320 112C383.1 112 439.6 140.1 477.8 184.5C486.4 194.6 501.6 195.7 511.6 187.1C521.6 178.5 522.8 163.3 514.2 153.3C467.3 98.6 397.7 64 320 64C178.6 64 64 178.6 64 320L64 360C64 373.3 74.7 384 88 384C101.3 384 112 373.3 112 360L112 320zM570.5 267.1C567.8 254.1 555 245.8 542.1 248.6C529.2 251.4 520.8 264.1 523.6 277C526.5 290.9 528.1 305.3 528.1 320.1L528.1 360.1C528.1 373.4 538.8 384.1 552.1 384.1C565.4 384.1 576.1 373.4 576.1 360.1L576.1 320.1C576.1 302 574.2 284.3 570.6 267.2zM320 144C301 144 282.6 147 265.5 152.6C250.3 157.6 246.8 176.3 257.2 188.5C264.3 196.8 276 199.3 286.6 196.4C297.2 193.5 308.4 192 320 192C390.7 192 448 249.3 448 320L448 344.9C448 370.1 446.5 395.2 443.6 420.2C441.9 434.8 453 448 467.8 448C479.6 448 489.7 439.4 491.1 427.7C494.4 400.3 496.1 372.7 496.1 345L496.1 320.1C496.1 222.9 417.3 144.1 320.1 144.1zM214.7 212.7C205.6 202.1 189.4 201.3 180.8 212.3C157.7 242.1 144 279.4 144 320L144 344.9C144 369.1 141.4 393.3 136.2 416.8C132.8 432.4 144.1 447.9 160.1 447.9C170.6 447.9 180 440.9 182.3 430.6C188.7 402.5 192 373.8 192 344.8L192 319.9C192 292.7 200.5 267.5 214.9 246.8C222.1 236.4 222.9 222.2 214.7 212.6zM320 224C267 224 224 267 224 320L224 344.9C224 380.8 219.4 416.4 210.2 451C206.4 465.3 216.9 480 231.7 480C241.2 480 249.6 473.8 252.1 464.6C262.6 425.6 268 385.4 268 344.9L268 320C268 291.3 291.3 268 320 268C348.7 268 372 291.3 372 320L372 344.9C372 381.2 368.5 417.3 361.6 452.8C358.9 466.7 369.3 480 383.4 480C393.6 480 402.4 473 404.4 463C412.1 424.2 416 384.7 416 344.9L416 320C416 267 373 224 320 224zM344 320C344 306.7 333.3 296 320 296C306.7 296 296 306.7 296 320L296 344.9C296 404.8 285 464.2 263.5 520.1L257.6 535.4C252.8 547.8 259 561.7 271.4 566.4C283.8 571.1 297.7 565 302.4 552.6L308.3 537.3C331.9 475.9 344 410.7 344 344.9L344 320z"/></svg>
    </header>
    <button id="analyseBtn" aria-label="Analyse My Browser"><b>Analyse My Browser</b></button>
    
    <div class="results" id="results">
        <div class="summary">
            <h2>Fingerprint Summary</h2>
            <p class="summary-p" style="white-space: nowrap;"><strong>Hash:</strong> <code id="hashDisplay" aria-live="polite" aria-atomic="true"></code></p>
            <p class="explanation">This is an encoding of every fingerprinting metric displayed on this site.</p>
            <p class="summary-p"><strong>Uniqueness Score:</strong> <code id="scoreDisplay" aria-live="polite" aria-atomic="true"></code></p>
            <p class="explanation">This estimates how distinguishable your browser is in a crowd.</p>
        </div>
        
        <div class="cards" id="cards"></div>
    </div>
</main>
    
    
    
    
    <footer>
        <a href="#legal" id="legalLink">Legal</a> •
        <a href="#changelog" id="changelogLink">Changelog</a> •
        <a href="#feedback" id="feedbackLink">Feedback</a>
    </footer>
    





<div class="modal" id="legalModal">
    <div class="modal-content">
        <button class="closeModal" aria-label="Close modal">&times;</button>
        <h2>Legal Disclaimer</h2>
        <p>This tool is for educational purposes only, and it does not collect, store, transmit, or share any user data. You are responsible for how you use the information provided. Use at your own risk.</p>
        <p>Results are estimates of browser fingerprint uniqueness; they do not identify you personally.</p>
        <p>No coookies or local storage is used. There is no server-side logging or analytics, and all data is processed client-side. All information that is collected is displayed to you.</p>
        <p>Imprint is fully open source, and the source code can be viewed <a href="https://github.com/imprintaudit/imprintaudit.github.io">here</a>.</p>
    </div>
</div>

<div class="modal" id="changelogModal">
  <div class="modal-content">
    <button class="closeModal" aria-label="Close modal">&times;</button>
    <h2>Changelog</h2>
    <ul>
      <li><strong>v1.2 (Jan 2026)</strong> Added dynamic range and color gamut detection.</li>
      <li><strong>v1.1 (Dec 2025)</strong> Audio fingerprinting and WebGL detection improved.</li>
      <li><strong>v1.0 (Nov 2025)</strong> Initial release with Canvas, Fonts, Screen, and Accessibility detection.</li>
    </ul>
  </div>
</div>

<div class="modal" id="feedbackModal">
  <div class="modal-content">
    <button class="closeModal" aria-label="Close modal">&times;</button>
    <h2>Feedback / Bug Report</h2>
    <p>If you encounter a bug or have feedback, please describe it below:</p>
    <textarea id="feedbackText" rows="5" style="width:100%; padding:0.5rem; border-radius:var(--radius); border:1px solid #ccc; font-family:inherit; background: var(--code);"></textarea>
    <button id="submitFeedback" style="margin-top:0.5rem; background:var(--accent); color:white; border:none; padding:0.5rem 1rem; border-radius:var(--radius); cursor:pointer;">Submit</button>
    <p id="feedbackMessage" style="margin-top:0.5rem; color:var(--muted); font-size:0.9rem;"></p>
  </div>
</div>


<script>
const modals = {
  legalLink: 'legalModal',
  changelogLink: 'changelogModal',
  feedbackLink: 'feedbackModal'
};

let activeModal = null;
let lastFocusedElement = null;

// Helpers
function openModal(modal) {
  lastFocusedElement = document.activeElement;

  modal.style.display = 'flex';
  modal.setAttribute('aria-modal', 'true');
  modal.removeAttribute('aria-hidden');

  // Make background non-interactive
  const main = document.querySelector('main');
  const footer = document.querySelector('footer');
  if (main) main.inert = true;
  if (footer) footer.inert = true;

  activeModal = modal;

  // Focus first focusable element inside modal
  const focusable = modal.querySelector(
    'button, [href], input, textarea, select, [tabindex]:not([tabindex="-1"])'
  );
  if (focusable) focusable.focus();
}

function closeModal(modal) {
  modal.style.display = 'none';
  modal.removeAttribute('aria-modal');
  modal.setAttribute('aria-hidden', 'true');

  // Restore background interactivity
  const main = document.querySelector('main');
  const footer = document.querySelector('footer');
  if (main) main.inert = false;
  if (footer) footer.inert = false;

  activeModal = null;
  if (lastFocusedElement) lastFocusedElement.focus();
}

// Open modals
Object.keys(modals).forEach(function(linkId) {
  const trigger = document.getElementById(linkId);
  const modal = document.getElementById(modals[linkId]);

  if (!trigger || !modal) return;

  trigger.addEventListener('click', function(e) {
    e.preventDefault();
    openModal(modal);
  });
});

// Close buttons
document.querySelectorAll('.closeModal').forEach(function(btn) {
  btn.addEventListener('click', function() {
    const modal = btn.closest('.modal');
    if (modal) closeModal(modal);
  });
});

// Click outside modal content
document.querySelectorAll('.modal').forEach(function(modal) {
  modal.addEventListener('click', function(e) {
    if (e.target === modal) closeModal(modal);
  });
});

// Escape key closes modal
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape' && activeModal) {
    closeModal(activeModal);
  }
});


document.getElementById('submitFeedback').addEventListener('click', () => {
  const text = document.getElementById('feedbackText').value.trim();
  const messageEl = document.getElementById('feedbackMessage');

  if (!text) {
    messageEl.textContent = "Please enter feedback before submitting.";
    return;
  }

  messageEl.textContent = "Thank you! Feedback submitted (demo mode).";
  document.getElementById('feedbackText').value = '';
});
</script>
<!--<a href="mailto:you@example.com?subject=Browser Fingerprint Feedback&body=Enter your feedback here">Send Feedback</a>-->











    <script>
        const darkModeQuery = window.matchMedia('(prefers-color-scheme: dark)');
        
        function applyDarkMode(e) {
            document.documentElement.classList.toggle('dark', e.matches);
        }

        applyDarkMode(darkModeQuery);

        darkModeQuery.addEventListener('change', applyDarkMode);



        const fontsToTest = [
            "Arial", "Times New Roman", "Courier New", "Roboto", "Georgia", "Verdana", "Trebuchet MS", "Fira Code", "JetBrains Mono", "Comic Sans MS"
        ];

        function detectFonts() {
            try {
                const baseFonts = ["monospace", "sans-serif", "serif"];
                const testString = "mmmmmmmmmmlli";
                const testSize = "72px";
                const canvas = document.createElement("canvas");
                const context = canvas.getContext("2d");

                const defaultWidths = {};
                baseFonts.forEach(base => {
                    context.font = `${testSize} ${base}`;
                    defaultWidths[base] = context.measureText(testString).width;
                });

                return fontsToTest.filter(font => {
                    return baseFonts.some(base => {
                        context.font = `${testSize} '${font}', ${base}`;
                        return context.measureText(testString).width !== defaultWidths[base];
                    });
                });
            } catch {
                return 'unavailable';
            }
        }

        function getWebGLInfo() {
            try {
                const canvas = document.createElement("canvas");
                const gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
                if (!gl) return {
                    vendor: "unavailable", 
                    renderer: "unavailable"
                };
                const debugInfo = gl.getExtension("WEBGL_debug_renderer_info");
                return debugInfo ? {
                    vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),
                    renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)
                } : {vendor: "unavailable", renderer: "unavailable"};
            } catch {
                return {vendor: 'unavailable', renderer: 'unavailable'};
            }
        }

        function getCanvasFingerprint() {
            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = 300;
                canvas.height = 150;

                const gradient = ctx.createLinearGradient(0,0, 300, 150);
                gradient.addColorStop(0, '#ff00ff');
                gradient.addColorStop(1, '#00ffff');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                ctx.textBaseline = 'top';
                ctx.font = "16px 'Arial'";
                ctx.fillStyle = '#000';
                ctx.fillText('Fingerprint Test 123!', 10, 10);

                ctx.font = "18px 'Times New Roman'";
                ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                ctx.fillText('Canvas entropy', 10, 40);

                ctx.strokeStyle = '#ff9900';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(200, 75, 40, 0, Math.PI * 2);
                ctx.stroke();

                ctx.fillStyle = 'rgba(102, 204, 0, 0.6)';
                ctx.fillRect(220, 20, 50, 60);

                return canvas.toDataURL();
            } catch {
                return 'unavailable';
            }
        }

        async function getAudioFingerprint() {
            try {
                const audioCtx = new (window.OfflineAudioContext || window.webkitOfflineAudioContext)(1, 44100, 44100);

                const oscillator = audioCtx.createOscillator();
                oscillator.type = "triangle";
                oscillator.frequency.value = 10000;

                const compressor = audioCtx.createDynamicsCompressor();
                compressor.threshold.value = -50;
                compressor.knee.value = 40;
                compressor.ratio.value = 12;
                compressor.attack.value = 0;
                compressor.release.value = 0.25;

                oscillator.connect(compressor);
                compressor.connect(audioCtx.destination);
                oscillator.start(0);

                const buffer = await audioCtx.startRendering();
                const data = buffer.getChannelData(0);

                let sum = 0;
                for (let i = 4500;i < 5000; i++) {
                    sum += Math.abs(data[i])
                }

                return sum.toString();
            } catch {
                return "unavailable";
            }
        }

        //alert(screen.availWidth);
        //alert(screen.availHeight);

        async function getMediaDeviceInfo() {
            try {
                const devices = await navigator.mediaDevices.enumerateDevices();

                const counts = {
                    audioinput: 0,
                    audiooutput: 0,
                    videoinput: 0,
                };

                devices.forEach(device => {
                    counts[device.kind]++;
                });

                return counts;
            } catch (err) {
                return { error: "unavailable"};
            }
        }

        const mediaInfo = JSON.stringify(getMediaDeviceInfo(), null, 2);

        function getMimeTypes() {
            if (!navigator.mimeTypes) return 'unavailable';
            const mimes = Array.from(navigator.mimeTypes).map(m => m.type).filter(Boolean);
            return mimes.length ? mimes.join(', ') : 'unavailable';
        }

        //alert(screen.orientation.type);
        //alert(window.matchMedia('(pointer: coarse)').matches ? 'Coarse' : 'Fine');
        //alert(window.orientation);
        //alert(navigator.getBattery().dischargingTime);
        //alert(hover: hover);

        function getColorGamut() {
            try {    
                if (matchMedia("(color-gamut: rec2020)").matches) return "rec2020";
                if (matchMedia("(color-gamut: p3)").matches) return "p3";
                if (matchMedia("(color-gamut: srgb)").matches) return "srgb";
                return "unavailable";
            } catch {
                return 'unavailable';
            }
        }

        function getDynamicRange() {
            try {
                return matchMedia("(dynamic-range: high)").matches ? "HDR" : "SDR";
            } catch {
                return 'unavailable';
            }
        }

        function getAccessibility() {
            try {
                const preferences = {
                    reducedMotion: window.matchMedia('(prefers-reduced-motion: reduce)').matches,
                    highContrast: window.matchMedia('(prefers-contrast: more)').matches,
                    reducedData: window.matchMedia('(prefers-reduced-data: reduce)').matches,
                };

                return preferences;
            } catch {
                return 'unavailable';
            }
        }

        function getCSSSupports() {
            try {
                const supports = {
                    filter: CSS.supports("backdrop-filter", "blur(10px)"),
                    container: CSS.supports("container-type", "inline-size"),
                    tech: CSS.supports("font-tech(color-COLRv1)"),
                    accent: CSS.supports("accent-color", "auto"),
                }
                return supports;
            } catch {
                return 'unavailable';
            }
        }

        const featureSupport = {
                usb: "usb" in navigator,
                bluetooth: "bluetooth" in navigator,
                hid: "hid" in navigator,
                serial: "serial" in navigator,
                share: "share" in navigator,
        };

        //alert(featureSupport.usb);

        function calculateScore(data) {
            let score = 0;
            if (data.fonts.length > 6) score += 30;
            if (![1920, 1366, 1536].includes(data.screen.width)) score += 20;
            if (data.webgl.renderer !== "unavailable") score += 20;
            if (data.hardwareConcurrency >= 8) score += 15;
            if (data.languages.length > 1) score += 15;
            return score;
        }

        function riskBadge(level) {
            return `<span class="badge ${level.toLowerCase()}">${level}</span>`;
        }

        function addCard(title, value, risk, explanation) {
            const card = document.createElement("div");
            card.className = "card";
            card.innerHTML = `
                <h3>${title} ${riskBadge(risk)}</h3>
                <code>${value}</code>
                <p class="explanation">${explanation}</p>
            `;
            document.getElementById("cards").appendChild(card);
        }

        function deepSort(value) {
            if (Array.isArray(value)) {
                return value.map(deepSort);
            }

            if (value && typeof value === "object") {
                return Object.keys(value)
                .sort()
                .reduce((result, key) => {
                    result[key] = deepSort(value[key]);
                    return result;
                }, {});
            }

            return value;
        }

        async function hashFingerprint(obj) {
            const canonical = deepSort(obj);
            const encoded = new TextEncoder().encode(JSON.stringify(canonical));
            const hashBuffer = await crypto.subtle.digest("SHA-256", encoded);

            return Array.from(new Uint8Array(hashBuffer))
                .map(b => b.toString(16).padStart(2, "0"))
                .join("");
        }

        function renderFixes(fingerprint) {
            const existing = document.getElementById('fixes');
            if (existing) existing.remove();

            const section = document.createElement('section');
            section.className = 'summary';
            section.id = 'fixes';
            let fixes = [];

            if (!['1920x1080', '1366x768', '1536x864'].includes(`${fingerprint.screen.width}x${fingerprint.screen.height}`)) {
                fixes.push({
                    issue: 'Uncommon screen resolution',
                    fix: 'Use more common window sizes like 1920x1080 or 1366x768 to blend in with typical users.'
                });
            }

            /*if () {
                fixes.push({
                    issue: '',
                    fix: ''
                });
            }*/

            if (fingerprint.fonts.length > 3) {
                fixes.push({
                    issue: 'High font uniqueness',
                    fix: 'Remove uncommon developer fonts like Fira Code, or use a privacy focused browser.'
                });
            }

            if (fingerprint.webgl.renderer && fingerprint.webgl.renderer.toLowerCase() !== 'unavailable') {
                fixes.push({
                    issue: 'GPU reveals hardware details',
                    fix: 'Use a privacy focused browser to obscure GPU information.'
                });
            }

            if (fingerprint.languages.length > 2) {
                fixes.push({
                    issue: 'High quantity of installed languages',
                    fix: 'Consider deleting unnecessary languages.'
                });
            }

            if (fixes.length === 0) {
                fixes.push({
                    issue: 'No major fingerprinting risks detected',
                    fix: 'Good job.'
                });
            }

            section.innerHTML = `<h2>Fix My Fingerprint</h2>` +
                fixes.map(f =>
                    `<div style="margin-bottom: 1rem">
                        <strong>${f.issue}</strong>
                        <p style="margin: 0.2rem 0; color: var(--muted)">${f.fix}</p>
                    </div>`
                ).join('');

            document.getElementById('results').prepend(section);
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('analyseBtn').click();
            }
        });

        document.getElementById("analyseBtn").onclick = async () => {
            const fonts = detectFonts();
            const webgl = getWebGLInfo();
            const accessibilityPreferences = getAccessibility();
            const cssSupports = getCSSSupports();

            const fingerprint = {
                screen: {
                    width: screen.width,
                    height: screen.height,
                    colorDepth: screen.colorDepth,
                    dpr: window.devicePixelRatio,
                    gamut: getColorGamut(),
                    range: getDynamicRange()
                },
                accessibility: {
                    reducedMotion: accessibilityPreferences.reducedMotion,
                    contrast: accessibilityPreferences.highContrast,
                    reducedData: accessibilityPreferences.reducedData
                },
                supports: {
                    filter: cssSupports.filter,
                    container: cssSupports.container,
                    tech: cssSupports.tech,
                    accent: cssSupports.accent
                },
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                languages: navigator.languages,
                hardwareConcurrency: navigator.hardwareConcurrency,
                memory: navigator.deviceMemory,
                touch: navigator.maxTouchPoints,
                canvas: getCanvasFingerprint(),
                audio: await getAudioFingerprint(),
                mime: getMimeTypes(),
                fonts,
                webgl
            };

            renderFixes(fingerprint);

            const hash = await hashFingerprint(fingerprint);
            const score = calculateScore(fingerprint);

            document.getElementById("hashDisplay").textContent = hash;
            document.getElementById("scoreDisplay").textContent = `${score}/100 (${score>70?"High":score>30?"Moderate":"Low"} uniqueness)`;

            document.getElementById("cards").innerHTML = "";

            addCard("Audio", fingerprint.audio, "High Threat", "The hash generated by the audio compressor can determine audio stacks.");

            addCard("Fonts", `${fingerprint.fonts.length} detected`, "High Threat", "Font combinations are often highly unique and stable.");
            
            addCard("Canvas", fingerprint.canvas, "High Threat", "The hash generated by the canvas can reveal GPU drivers and OS graphics stacks.");

            addCard("Accessibility", `reduced motion: ${fingerprint.accessibility.reducedMotion}, high contrast: ${fingerprint.accessibility.contrast}, reduced data: ${fingerprint.accessibility.reducedData}`, "High Threat", "Accessibility preferences can be very unique when viewed in combination.");

            addCard("CSS Supports", `backdrop filter: ${fingerprint.supports.filter}, container type: ${fingerprint.supports.container}, font tech: ${fingerprint.supports.tech}, accent colour: ${fingerprint.supports.accent}`, "Medium Threat", "CSS supports can reveal browser information when viewed in combination.");

            addCard('Screen', `${fingerprint.screen.width}x${fingerprint.screen.height}, ${fingerprint.screen.dpr} DPR`, "Medium Threat", "Unusual screen setups can increase fingerprint uniqueness.");
            
            addCard('Colour', `${fingerprint.screen.colorDepth}-bit, ${fingerprint.screen.gamut}, ${fingerprint.screen.range}`, "Medium Threat", "Unusual colour setups can reveal device characteristics.");
            
            addCard('MIME Types', fingerprint.mime, "Medium Threat", "Supported MIME types can reveal browser version information and personal preferences.");

            addCard("GPU", fingerprint.webgl.renderer, "Medium Threat", "Graphics hardware helps distinguish devices.");
            
            addCard("CPU Threads", fingerprint.hardwareConcurrency, "Medium Threat", "CPU thread count can narrow device types.");
            
            addCard("RAM Count", fingerprint.memory, "Medium Threat", "Unusual RAM counts can often distinguish devices.");

            addCard("Languages", fingerprint.languages.join(", "), "Low Threat", "Installed languages are rarely changed, but may still be a factor.");
            
            addCard("Touchscreen", `${fingerprint.touch} touchpoints`, "Low Threat", "The number of touchpoints can differentiate device types.");
            
            addCard("Locale", fingerprint.timezone, "Low Threat", "Common locales offer little uniqueness but still contribute.");

            document.getElementById("results").style.display = "block";

        };
    </script>

    <script>
        document.addEventListener("click", async (e) => {
            const codeEl = e.target.closest("code");
            if (!codeEl) return;

            const originalText = codeEl.textContent;

            try {
                await navigator.clipboard.writeText(originalText);

                codeEl.textContent = "Copied!";
                codeEl.classList.add("copied");

                setTimeout(() => {
                    codeEl.textContent = originalText;
                    codeEl.classList.remove("copied");
                }, 800);
            } catch (err) {
                codeEl.textContent = "Copy failed!";
                codeEl.classList.add("copied");

                setTimeout(() => {
                    codeEl.textContent = originalText;
                    codeEl.classList.remove("copied");
                }, 800);
            }
        });
    </script>
</body>
</html>
